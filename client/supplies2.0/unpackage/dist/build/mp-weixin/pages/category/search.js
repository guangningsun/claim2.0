(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/category/search"],{"3c3d":function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=function(){e.e("node-modules/@dcloudio/uni-ui/lib/uni-fab/uni-fab").then(function(){return resolve(e("b63f"))}.bind(null,e)).catch(e.oe)},a={components:{uniFab:s},data:function(){return{showEmptySupplier:!1,CustomBar:this.CustomBar,modalName:null,current_item_info:null,supplier_id_radio:-1,is_no_supplier:!1,showEmpty:!1,showNoMore:!1,catList:getApp().globalData.cartList,tabCur:0,mainCur:0,load:!0,item_supplier_list:[],cart_item_id_list:getApp().globalData.cart_item_id_list,cartList:[],domain:getApp().globalData.domain,default_img:'this.src="'+e("4a51")+'"',directionStr:"垂直",horizontal:"right",vertical:"bottom",direction:"horizontal",pattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#2481c4",buttonColor:"#59aef9"},content:[{iconPath:"/static/cart.png",selectedIconPath:"/static/cart.png",text:"物品篮",active:!0},{iconPath:"/static/order_list.png",selectedIconPath:"/static/order_list.png",text:"历史订单",active:!0}],cateDetailAllList:[],assetList:[],search_item_name:""}},onLoad:function(){this.cart_item_id_list=getApp().globalData.cart_list_info.map((function(t){return Object.assign({id:t.id})})),getApp().globalData.cart_item_id_list=this.cart_item_id_list},onShow:function(){this.loadData()},methods:{RadioChange:function(t){this.supplier_id_radio=t.detail.value,console.log("select supplier: "+this.supplier_id_radio);var i=this.getSupplierById(this.supplier_id_radio);this.selected_supplier_id=i.supplier_name_id,this.selected_supplier_name=i.supplier_name,this.select_supplier_price=i.price},getSupplierById:function(t){if(this.item_supplier_list.length>0)for(var i=0;i<this.item_supplier_list.length;i++){var e=this.item_supplier_list[i].id;if(e==t)return this.item_supplier_list[i]}return""},requestSupplierList:function(t){this.item_supplier_list=[],this.requestWithMethod(getApp().globalData.api_get_supplier+t,"GET","",this.successSupplierCb,this.failSupplierCb,this.completeSupplierCb)},successSupplierCb:function(t){var i=!0;for(var e in t.data)i=!1;this.showEmptySupplier=i,0===t.data.error&&(this.item_supplier_list=t.data.msg.supplier_list,console.log("supplier list:"),this.item_supplier_list.sort((function(t,i){return parseFloat(t.price)-parseFloat(i.price)})),console.log(this.item_supplier_list))},failSupplierCb:function(t){console.log("api_get_supplier failed",t)},completeSupplierCb:function(t){},showModal:function(t){this.modalName="ChooseSupplierModal",this.current_item_info=t,console.log(t),this.requestSupplierList(this.current_item_info.asset_sn)},hideModal:function(t){this.modalName=null},onAdd:function(t){this.showModal(t)},onAddToCart:function(){console.log("supplier: "+this.selected_supplier_name),this.current_item_info.selected_supplier_name=this.selected_supplier_name,this.current_item_info.selected_supplier=this.selected_supplier_id,this.current_item_info.selected_supplier_price=this.select_supplier_price;var t=!1,i=parseFloat(this.current_item_info.asset_limit_price),e=parseFloat(this.select_supplier_price);if(0==i?t=!1:i<e&&(t=!0),this.current_item_info.is_exceed=t,0==getApp().globalData.cart_list_info.length)return getApp().globalData.cart_list_info.push(this.current_item_info),this.showToast("成功添加到物品篮"),console.log(getApp().globalData.cart_list_info),this.hideModal(),void(this.supplier_id_radio=-1);for(var s=0;s<getApp().globalData.cart_list_info.length;s++)if(getApp().globalData.cart_list_info[s].asset_sn==this.current_item_info.asset_sn)return this.showToast(this.current_item_info.asset_sn+" 已添加过了，无须重复添加"),console.log(getApp().globalData.cart_list_info),this.hideModal(),void(this.supplier_id_radio=-1);getApp().globalData.cart_list_info.push(this.current_item_info),console.log(getApp().globalData.cart_list_info),this.showToast(this.current_item_info.asset_name+" 成功添加到物品篮"),this.hideModal(),this.supplier_id_radio=-1},onMinus:function(t){for(var i=0;i<getApp().globalData.cart_list_info.length;i++)if(getApp().globalData.cart_list_info[i].asset_name==t.asset_name)return getApp().globalData.cart_list_info.splice(i,1),this.showToast(t.asset_name+"成功从物品篮删除"),void console.log(getApp().globalData.cart_list_info);this.showToast("物品篮无 "+t.asset_name+"，无须删除"),console.log(getApp().globalData.cart_list_info)},trigger:function(i){console.log("trigger"),0===i.index?t.navigateTo({url:"../cart/cart"}):1===i.index&&t.navigateTo({url:"../order/order_list"})},successCb:function(i){if(0===i.data.error){if(this.assetList=i.data.msg.asset_info,console.log("asset_info:"),console.log(this.assetList),this.assetList.length>0&&(this.showNoMore=!0),0==this.assetList.length)return void(this.showEmpty=!0);var e=this.assetList.map((function(t,i,e){return Object.assign(t,{stock:999},{number:0},{total_price:0},{selected_supplier:0},{selected_supplier_name:""},{selected_supplier_price:""},{is_exceed:!1})}));e.map((function(t){t.stock=parseInt(t.asset_count)})),this.assetList=e,console.log(this.assetList)}t.hideLoading()},failCb:function(i){t.hideLoading(),console.log("api_category failed",i)},completeCb:function(t){},loadData:function(){t.showLoading({title:"搜索中...",mask:!0}),this.requestWithMethod(getApp().globalData.get_asset_by_cname+getApp().globalData.search_item_name,"GET","",this.successCb,this.failCb,this.completeCb)}}};i.default=a}).call(this,e("543d")["default"])},"453e":function(t,i,e){"use strict";var s,a=function(){var t=this,i=t.$createElement,e=(t._self._c,t.__map(t.assetList,(function(i,e){var s=parseFloat(i.asset_limit_price);return{$orig:t.__get_orig(i),m0:s}})));t.$mp.data=Object.assign({},{$root:{l0:e}})},o=[];e.d(i,"b",(function(){return a})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){return s}))},"60c4":function(t,i,e){},6982:function(t,i,e){"use strict";var s=e("60c4"),a=e.n(s);a.a},8959:function(t,i,e){"use strict";e.r(i);var s=e("453e"),a=e("f267");for(var o in a)"default"!==o&&function(t){e.d(i,t,(function(){return a[t]}))}(o);e("6982");var l,n=e("f0c5"),r=Object(n["a"])(a["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],l);i["default"]=r.exports},c274:function(t,i,e){"use strict";(function(t){e("80e3");s(e("66fd"));var i=s(e("8959"));function s(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,e("543d")["createPage"])},f267:function(t,i,e){"use strict";e.r(i);var s=e("3c3d"),a=e.n(s);for(var o in s)"default"!==o&&function(t){e.d(i,t,(function(){return s[t]}))}(o);i["default"]=a.a}},[["c274","common/runtime","common/vendor"]]]);