(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/category/search"],{"3c3d":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=function(){i.e("node-modules/@dcloudio/uni-ui/lib/uni-fab/uni-fab").then(function(){return resolve(i("b63f"))}.bind(null,i)).catch(i.oe)},a={components:{uniFab:s},data:function(){return{showEmptySupplier:!1,CustomBar:this.CustomBar,modalName:null,current_item_info:null,supplier_id_radio:-1,is_no_supplier:!1,showEmpty:!1,showNoMore:!1,catList:getApp().globalData.cartList,tabCur:0,mainCur:0,load:!0,item_supplier_list:[],cart_item_id_list:getApp().globalData.cart_item_id_list,cartList:[],domain:getApp().globalData.domain,default_img:'this.src="'+i("4a51")+'"',directionStr:"垂直",horizontal:"right",vertical:"bottom",direction:"horizontal",pattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#2481c4",buttonColor:"#59aef9"},content:[{iconPath:"/static/cart.png",selectedIconPath:"/static/cart.png",text:"物品篮",active:!0}],cateDetailAllList:[],assetList:[],search_item_name:""}},onLoad:function(){this.cart_item_id_list=getApp().globalData.cart_list_info.map((function(t){return Object.assign({id:t.id})})),getApp().globalData.cart_item_id_list=this.cart_item_id_list},onShow:function(){this.loadData()},methods:{RadioChange:function(t){this.supplier_id_radio=t.detail.value,console.log("select supplier: "+this.supplier_id_radio);var e=this.getSupplierById(this.supplier_id_radio);this.selected_supplier_id=e.supplier_name_id,this.selected_supplier_name=e.supplier_name,this.select_supplier_price=e.price},getSupplierById:function(t){if(this.item_supplier_list.length>0)for(var e=0;e<this.item_supplier_list.length;e++){var i=this.item_supplier_list[e].id;if(i==t)return this.item_supplier_list[e]}return""},requestSupplierList:function(t){this.item_supplier_list=[],this.requestWithMethod(getApp().globalData.api_get_supplier+t,"GET","",this.successSupplierCb,this.failSupplierCb,this.completeSupplierCb)},successSupplierCb:function(t){var e=!0;for(var i in t.data)e=!1;this.showEmptySupplier=e,0===t.data.error&&(this.item_supplier_list=t.data.msg.supplier_list,console.log("supplier list:"),console.log(this.item_supplier_list))},failSupplierCb:function(t){console.log("api_get_supplier failed",t)},completeSupplierCb:function(t){},showModal:function(t){this.modalName="ChooseSupplierModal",this.current_item_info=t,console.log(t),this.requestSupplierList(this.current_item_info.asset_sn)},hideModal:function(t){this.modalName=null},onAdd:function(t){this.showModal(t)},onAddToCart:function(){console.log("supplier: "+this.selected_supplier_name),this.current_item_info.selected_supplier_name=this.selected_supplier_name,this.current_item_info.selected_supplier=this.selected_supplier_id,this.current_item_info.selected_supplier_price=this.select_supplier_price;var t=!1,e=parseFloat(this.current_item_info.asset_limit_price),i=parseFloat(this.select_supplier_price);if(0==e?t=!1:e<i&&(t=!0),this.current_item_info.is_exceed=t,0==getApp().globalData.cart_list_info.length)return getApp().globalData.cart_list_info.push(this.current_item_info),this.showToast("成功添加到物品篮"),console.log(getApp().globalData.cart_list_info),void this.hideModal();for(var s=0;s<getApp().globalData.cart_list_info.length;s++)if(getApp().globalData.cart_list_info[s].asset_sn==this.current_item_info.asset_sn)return this.showToast(this.current_item_info.asset_sn+" 已添加过了，无须重复添加"),console.log(getApp().globalData.cart_list_info),void this.hideModal();getApp().globalData.cart_list_info.push(this.current_item_info),console.log(getApp().globalData.cart_list_info),this.showToast(this.current_item_info.asset_name+" 成功添加到物品篮"),this.hideModal()},onMinus:function(t){for(var e=0;e<getApp().globalData.cart_list_info.length;e++)if(getApp().globalData.cart_list_info[e].asset_name==t.asset_name)return getApp().globalData.cart_list_info.splice(e,1),this.showToast(t.asset_name+"成功从物品篮删除"),void console.log(getApp().globalData.cart_list_info);this.showToast("物品篮无 "+t.asset_name+"，无须删除"),console.log(getApp().globalData.cart_list_info)},trigger:function(e){console.log("trigger"),0===e.index&&t.navigateTo({url:"../cart/cart"})},successCb:function(e){if(0===e.data.error){if(this.assetList=e.data.msg.asset_info,console.log("asset_info:"),console.log(this.assetList),this.assetList.length>0&&(this.showNoMore=!0),0==this.assetList.length)return void(this.showEmpty=!0);var i=this.assetList.map((function(t,e,i){return Object.assign(t,{stock:999},{number:0},{total_price:0},{selected_supplier:0},{selected_supplier_name:""},{selected_supplier_price:""},{is_exceed:!1})}));i.map((function(t){t.stock=parseInt(t.asset_count)})),this.assetList=i,console.log(this.assetList)}t.hideLoading()},failCb:function(e){t.hideLoading(),console.log("api_category failed",e)},completeCb:function(t){},loadData:function(){t.showLoading({title:"搜索中...",mask:!0}),this.requestWithMethod(getApp().globalData.get_asset_by_cname+getApp().globalData.search_item_name,"GET","",this.successCb,this.failCb,this.completeCb)}}};e.default=a}).call(this,i("543d")["default"])},"60c4":function(t,e,i){},6982:function(t,e,i){"use strict";var s=i("60c4"),a=i.n(s);a.a},8959:function(t,e,i){"use strict";i.r(e);var s=i("b218"),a=i("f267");for(var o in a)"default"!==o&&function(t){i.d(e,t,(function(){return a[t]}))}(o);i("6982");var l,n=i("f0c5"),r=Object(n["a"])(a["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],l);e["default"]=r.exports},b218:function(t,e,i){"use strict";var s,a=function(){var t=this,e=t.$createElement;t._self._c},o=[];i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return s}))},c274:function(t,e,i){"use strict";(function(t){i("80e3");s(i("66fd"));var e=s(i("8959"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("543d")["createPage"])},f267:function(t,e,i){"use strict";i.r(e);var s=i("3c3d"),a=i.n(s);for(var o in s)"default"!==o&&function(t){i.d(e,t,(function(){return s[t]}))}(o);e["default"]=a.a}},[["c274","common/runtime","common/vendor"]]]);