(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/category/category"],{"0c93":function(t,i,e){},"3a8f":function(t,i,e){"use strict";(function(t){e("80e3");s(e("66fd"));var i=s(e("3d45"));function s(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,e("543d")["createPage"])},"3d45":function(t,i,e){"use strict";e.r(i);var s=e("58c0"),a=e("79e4");for(var o in a)"default"!==o&&function(t){e.d(i,t,(function(){return a[t]}))}(o);e("b589");var r,l=e("f0c5"),n=Object(l["a"])(a["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],r);i["default"]=n.exports},"58c0":function(t,i,e){"use strict";var s,a=function(){var t=this,i=t.$createElement,e=(t._self._c,t.__map(t.catList,(function(i,e){var s=t.__map(i.asset_info,(function(i,e){var s=parseFloat(i.asset_limit_price);return{$orig:t.__get_orig(i),m0:s}}));return{$orig:t.__get_orig(i),l0:s}})));t.$mp.data=Object.assign({},{$root:{l1:e}})},o=[];e.d(i,"b",(function(){return a})),e.d(i,"c",(function(){return o})),e.d(i,"a",(function(){return s}))},"79e4":function(t,i,e){"use strict";e.r(i);var s=e("e5c2"),a=e.n(s);for(var o in s)"default"!==o&&function(t){e.d(i,t,(function(){return s[t]}))}(o);i["default"]=a.a},b589:function(t,i,e){"use strict";var s=e("0c93"),a=e.n(s);a.a},e5c2:function(t,i,e){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=function(){e.e("node-modules/@dcloudio/uni-ui/lib/uni-fab/uni-fab").then(function(){return resolve(e("b63f"))}.bind(null,e)).catch(e.oe)},a={components:{uniFab:s},data:function(){return{showEmptySupplier:!1,CustomBar:this.CustomBar,modalName:null,current_item_info:null,supplier_id_radio:-1,is_no_supplier:!1,showEmpty:!1,showNoMore:!1,catList:getApp().globalData.cartList,tabCur:0,mainCur:0,verticalNavTop:0,load:!0,item_supplier_list:[],cart_item_id_list:getApp().globalData.cart_item_id_list,cartList:[],domain:getApp().globalData.domain,default_img:'this.src="'+e("4a51")+'"',directionStr:"垂直",horizontal:"right",vertical:"bottom",direction:"horizontal",pattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#2481c4",buttonColor:"#59aef9"},content:[{iconPath:"/static/cart.png",selectedIconPath:"/static/cart.png",text:"物品篮",active:!0},{iconPath:"/static/order_list.png",selectedIconPath:"/static/order_list.png",text:"历史订单",active:!0}],cateDetailAllList:[]}},onLoad:function(){t.showLoading({title:"加载中...",mask:!0}),this.cart_item_id_list=getApp().globalData.cart_list_info.map((function(t){return Object.assign({id:t.id})})),getApp().globalData.cart_item_id_list=this.cart_item_id_list},onShow:function(){this.loadData()},methods:{onInput:function(t){var i=t.detail.value;this.search_item=i,getApp().globalData.search_item_name=i,console.log(getApp().globalData.search_item_name)},onSearch:function(){t.navigateTo({url:"./search"})},RadioChange:function(t){this.supplier_id_radio=t.detail.value,console.log("select supplier: "+this.supplier_id_radio);var i=this.getSupplierById(this.supplier_id_radio);this.selected_supplier_id=i.supplier_name_id,this.selected_supplier_name=i.supplier_name,this.select_supplier_price=i.price},getSupplierById:function(t){if(this.item_supplier_list.length>0)for(var i=0;i<this.item_supplier_list.length;i++){var e=this.item_supplier_list[i].id;if(e==t)return this.item_supplier_list[i]}return""},requestSupplierList:function(t){this.item_supplier_list=[],this.requestWithMethod(getApp().globalData.api_get_supplier+t,"GET","",this.successSupplierCb,this.failSupplierCb,this.completeSupplierCb)},successSupplierCb:function(t){var i=!0;for(var e in t.data)i=!1;this.showEmptySupplier=i,0===t.data.error&&(this.item_supplier_list=t.data.msg.supplier_list,console.log("supplier list:"),this.item_supplier_list.sort((function(t,i){return parseFloat(t.price)-parseFloat(i.price)})),console.log(this.item_supplier_list))},failSupplierCb:function(t){console.log("api_get_supplier failed",t)},completeSupplierCb:function(t){},showModal:function(t){this.modalName="ChooseSupplierModal",this.current_item_info=t,console.log(t),this.requestSupplierList(this.current_item_info.asset_sn)},hideModal:function(t){this.modalName=null},onAdd:function(t){this.showModal(t)},onAddToCart:function(){console.log("supplier: "+this.selected_supplier_name),this.current_item_info.selected_supplier_name=this.selected_supplier_name,this.current_item_info.selected_supplier=this.selected_supplier_id,this.current_item_info.selected_supplier_price=this.select_supplier_price;var t=!1,i=parseFloat(this.current_item_info.asset_limit_price),e=parseFloat(this.select_supplier_price);if(0==i?t=!1:i<e&&(t=!0),this.current_item_info.is_exceed=t,0==getApp().globalData.cart_list_info.length)return getApp().globalData.cart_list_info.push(this.current_item_info),this.showToast("成功添加到物品篮"),console.log(getApp().globalData.cart_list_info),this.hideModal(),void(this.supplier_id_radio=-1);for(var s=0;s<getApp().globalData.cart_list_info.length;s++)if(getApp().globalData.cart_list_info[s].asset_sn==this.current_item_info.asset_sn)return this.showToast(this.current_item_info.asset_sn+" 已添加过了，无须重复添加"),console.log(getApp().globalData.cart_list_info),this.hideModal(),void(this.supplier_id_radio=-1);getApp().globalData.cart_list_info.push(this.current_item_info),console.log(getApp().globalData.cart_list_info),this.showToast(this.current_item_info.asset_name+" 成功添加到物品篮"),this.hideModal(),this.supplier_id_radio=-1},onMinus:function(t){for(var i=0;i<getApp().globalData.cart_list_info.length;i++)if(getApp().globalData.cart_list_info[i].asset_sn==t.asset_sn)return getApp().globalData.cart_list_info.splice(i,1),this.showToast(t.asset_name+"成功从物品篮删除"),void console.log(getApp().globalData.cart_list_info);this.showToast("物品篮无 "+t.asset_name+"，无须删除"),console.log(getApp().globalData.cart_list_info)},trigger:function(i){console.log("trigger"),0===i.index?t.navigateTo({url:"../cart/cart"}):1===i.index&&t.navigateTo({url:"../order/order_list"})},successCb:function(i){if(0===i.data.error){if(this.catList=i.data.msg.commoditycategory,console.log("commoditycategory:"),console.log(this.catList),getApp().globalData.catList=this.cartList,this.catList.length>0&&(this.showNoMore=!0),0==this.catList.length)return void(this.showEmpty=!0);for(var e=0;e<this.catList.length;e++){var s=this.catList[e].asset_info.map((function(t,i,e){return Object.assign(t,{stock:999},{number:0},{total_price:0},{selected_supplier:0},{selected_supplier_name:""},{selected_supplier_price:""},{is_exceed:!1})}));s.map((function(t){t.stock=parseInt(t.asset_count)})),this.cartList=s}this.listCur=this.catList[0],this.mainCur=this.catList[0].id}t.hideLoading()},failCb:function(i){t.hideLoading(),console.log("api_category failed",i)},completeCb:function(t){},loadData:function(){this.requestWithMethod(getApp().globalData.api_category,"GET","",this.successCb,this.failCb,this.completeCb)},TabSelect:function(t){this.tabCur=t.currentTarget.dataset.id,this.mainCur=t.currentTarget.dataset.id,this.verticalNavTop=50*(t.currentTarget.dataset.id-1)},VerticalMain:function(i){var e=this,s=0;if(this.load){for(var a=function(i){var a=t.createSelectorQuery().select("#main-"+e.catList[i].id);a.fields({size:!0},(function(t){e.catList[i].top=s,s+=t.height,e.catList[i].bottom=s})).exec()},o=0;o<this.catList.length;o++)a(o);this.load=!1}for(var r=i.detail.scrollTop+10,l=0;l<this.catList.length;l++)if(r>this.catList[l].top&&r<this.catList[l].bottom)return this.verticalNavTop=50*(this.catList[l].id-1),this.tabCur=this.catList[l].id,!1}}};i.default=a}).call(this,e("543d")["default"])}},[["3a8f","common/runtime","common/vendor"]]]);